<!DOCTYPE html>
<html>

<head>
    <style>
        /* CSS for styling the seats */
        .seating-chart {
            display: grid;
            grid-template-columns: repeat(3, 70px);
            gap: 10px;
            justify-content: center;
        }

        .seat {
            width: 70px;
            height: 40px;
            text-align: center;
            line-height: 40px;
            border: 1px solid #ccc;
            cursor: pointer;
        }

        .booked {
            background-color: #FF0000;
            color: white;
            cursor: not-allowed;
        }

        .available {
            background-color: #7FFF00;
        }

        .select-button {
            width: 100%;
            padding: 10px;
            margin: 10px;
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
        }

        .reset-button {
            width: 100%;
            padding: 10px;
            margin: 10px;
            background-color: #7FFF00;
            border: none;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <h2>Movie Theater Seating</h2>

    <div id="seating-chart" class="seating-chart">
    </div>

    <button class="select-button" onclick="bookRandomSeat()">Select Random Seat</button>
    <button class="reset-button" onclick="resetSeats()">Reset Seats</button>

    <script>

        let theaterSeats = [
            ['X', 'O', 'X'],
            ['O', 'X', 'O'],
            ['X', 'O', 'X']
        ];

        window.onload = function () {
            arrangeSeats();
        }

        function arrangeSeats() {
            const seatingChart = document.getElementById("seating-chart");
            seatingChart.innerHTML = '';

            for (let row = 0; row < theaterSeats.length; row++) {
                for (let col = 0; col < theaterSeats[row].length; col++) {

                    const seat = document.createElement('div');
                    seat.textContent = `${String.fromCharCode(65 + row)}${col + 1}`;
                    seat.classList.add('seat');
                    // seat.dataset.row = row;
                    // seat.dataset.col = col;
                    seatingChart.appendChild(seat);
                    seat.addEventListener('click', () => bookSeat(row, col))

                    const status = (theaterSeats[row][col] === 'O') ? 'available' : 'booked';
                    seat.classList.add(status);
                }
            }
        }

        function bookSeat(row, col) {

            const seat = event.target;

            if (theaterSeats[row][col] === 'O') {
                theaterSeats[row][col] = 'X';
                seat.classList.remove('available')
                seat.classList.add('booked');
                alert(`Seat ${seat.textContent} is booked.`);
            } else {
                alert(`Seat ${seat.textContent} is already taken.`);
            }
        }

        function bookRandomSeat() {
            const availableSeats = [];

            for (let row = 0; row < theaterSeats.length; row++) {
                for (let col = 0; col < theaterSeats[row].length; col++) {
                    if (theaterSeats[row][col] === 'O') {
                        availableSeats.push({ row, col });
                    }
                }
            }

            if (availableSeats.length > 0) {
                const randomIndex = Math.floor(Math.random() * availableSeats.length);
                const { row, col } = availableSeats[randomIndex];

                // const seats = document.getElementsByClassName('seat')
                // const seat = seats[row * 3 + col]

                const seat = document.querySelector(`.seat:nth-child(${(row * 3 + col) + 1})`)

                seat.click(); // Triger click event of the rondamly selected seat to book it.

            } else {
                alert('All seats are already booked.');
            }
        }

        function resetSeats() {

            theaterSeats = theaterSeats.map(row => row.map(() => "O"));
            arrangeSeats();
        }
    </script>
</body>

</html>